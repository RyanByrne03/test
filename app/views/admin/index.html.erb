<h1>Admin Dashboard</h1>


<% if params[:password].nil? || params[:password] != ENV['ADMIN_PASSWORD'] %>
  <p>Please enter the password to access the admin page:</p>

  <%= form_with(url: admin_path, method: :get, local: true) do |form| %>
    <div>
      <%= form.label :password, "Password" %>
      <%= form.password_field :password %>
      <%= form.submit "Enter Admin" %>
    </div>
  <% end %>

<% else %>
<h2>All To-Dos</h2>
<ul>
  <% @todos.each do |todo| %>
    <li id="todo-<%= todo.id %>">
      <strong>Title:</strong> <%= todo.title %> |
      <strong>Status:</strong> <%= todo.completed ? 'Completed' : 'Incomplete' %> |
      <strong>Description:</strong> <%= todo.description %> |
      <%= button_to 'Delete',
                    admin_destroy_todo_path(todo),
                    method: :delete,
                    remote: true,
                    data: { confirm: 'Are you sure you want to delete this To-Do?' } %>
    </li>
  <% end %>
</ul>

<h2>Recent Logs</h2>
<div style="max-height: 300px; overflow-y: scroll; background: #f8f8f8; padding: 10px;">
  <% if @logs.present? %>
    <% @logs.each do |line| %>
      <pre><%= line %></pre>
    <% end %>
  <% else %>
    <p>No logs available.</p>
  <% end %>
</div>

<% end %>